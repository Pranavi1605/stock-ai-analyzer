<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ“Š My Portfolio</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h2>ðŸ“Š My Portfolio</h2>

<div id="portfolio" class="cards-container"></div>

<h3>Summary</h3>
<p>Total Invested: â‚¹<span id="total-invested">0</span></p>
<p>Current Value: â‚¹<span id="current-value">0</span></p>
<p>Profit / Loss: <span id="profit-loss">0</span> (<span id="direction">â†‘</span>)</p>

<canvas id="portfolioChart" style="max-width:400px;margin-top:20px;"></canvas>

<br>
<button onclick="navigate('home')">â¬… Back to Home</button>

<script src="script.js"></script>
<script>
  // Update profit-loss and direction after rendering portfolio
  function renderPortfolio(data) {
    let totalInvested = 0, totalCurrent = 0;

    data.stocks.forEach(s => {
      totalInvested += s.invested;
      totalCurrent += s.current_value;
    });

    const profit = totalCurrent - totalInvested;

    document.getElementById("total-invested").innerText = totalInvested.toFixed(2);
    document.getElementById("current-value").innerText = totalCurrent.toFixed(2);
    document.getElementById("profit-loss").innerText = profit.toFixed(2);
    document.getElementById("direction").innerText = profit >=0 ? "â†‘" : "â†“";

    document.getElementById("portfolio").innerHTML =
      data.stocks.map(p => `
        <div class="card">
          <p><b>${p.symbol}</b></p>
          <p>Qty: ${p.quantity}</p>
          <p>Invested: â‚¹${p.invested.toFixed(2)}</p>
          <p>Current: â‚¹${p.current_value.toFixed(2)}</p>
          <p>Profit: â‚¹${(p.current_value - p.invested).toFixed(2)}</p>
        </div>
      `).join("");

    drawPortfolioChart(data.stocks);
  }
</script>

</body>
</html>
